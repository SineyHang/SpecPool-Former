# Spectralformer: Rethinking hyperspectral image classification with transformers


    
System-specific notes
---------------------
The data were generated by Matlab R2016a or higher versions, and the codes of networks were tested using PyTorch 1.6 version (CUDA 12.1) in Python 3.7 on CentOS system.

How to use it?
---------------------

Here an example experiment is given by using **Indian Pines hyperspectral data**. Directly run **demo.py**.

:exclamation: Please kindly be careful on assigning arguments such as `epoches` and `weight_decay`.

ViT: `python demo.py --dataset='Indian' --epoch=300 --patches=1 --band_patches=1 --model='ViT&SpectralFormer' --mode='ViT' --weight_decay=0`

SpectralFormer: `python demo.py --dataset='Indian' --epoches=300 --patches=1 --band_patches=3 --model='ViT&SpectralFormer' --mode='CAF' --weight_decay=5e-3`

SpecPool-Former: `python demo.py --dataset='Indian' --epoches=300 --patches=1 --band_patches=5 --model='SpecPool' --mode='CAF' --weight_decay=5e-3`

1D-CNN(Hu):`python demo.py --dataset='Indian' --epoches=300 --patches=1 --band_patches=1 --model='1D-CNN' --mode='ViT' --weight_decay=5e-3`



For the datasets of **Pavia University**. Directly run **demo.py**.

ViT: `python demo.py --dataset='Pavia' --epoch=300 --patches=1 --band_patches=1 --model='ViT&SpectralFormer' --mode='ViT' --weight_decay=0`

SpectralFormer: `python demo.py --dataset='Pavia' --epoches=300 --patches=1 --band_patches=3 --model='ViT&SpectralFormer' --mode='CAF' --weight_decay=5e-3`

SpecPool-Former: `python demo.py --dataset='Pavia' --epoches=300 --patches=1 --band_patches=5 --model='SpecPool' --mode='CAF' --weight_decay=5e-3`

1D-CNN(Hu):`python demo.py --dataset='Pavia' --epoches=300 --patches=1 --band_patches=1 --model='1D-CNN' --mode='ViT' --weight_decay=5e-3`